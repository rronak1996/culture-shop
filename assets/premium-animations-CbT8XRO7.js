const w="https://script.google.com/macros/s/AKfycbyoN902SlucvKu2eF69MOFfznJ7XeZcb0UXFsLjqw3IoPD2PUd4bTsuayqQ875ZAuBA/exec",j="culture-secure-2025",I={note:"Use the chocolates before 1 month after purchasing",directions:"Put chocolates in refrigerator after getting order before using it",commonIngredients:"Chocolate base, premium toppings, zero added sugar, zero preservatives"},y=[{id:102,name:"Culture | Cranberry Cashew Majest√©",description:"Roasted almonds clustered in sugar-free dark chocolate.",price:179,image:"assets/crane.jpg",category:"sugar-free",ingredients:["Dark chocolate (70% cocoa)","Cranberry","Cashew","Roasted almonds","Natural sweetener (Stevia)"]},{id:201,name:"Culture | Pistachio Noir",description:"A heavenly assortment of White, Milk, and Dark chocolates.",price:179,image:"assets/pista.jpg",category:"triple-choco",ingredients:["White chocolate","Milk chocolate","Dark chocolate (70% cocoa)","Pistachio","Cocoa butter"]},{id:202,name:"Culture | Almond Cashew Supr√™me",description:"Three layers of chocolate perfection in every bite.",price:189,image:"assets/almond-cashew.jpg",category:"triple-choco",ingredients:["White chocolate","Milk chocolate","Dark chocolate","Almonds","Cashew","Cocoa butter"]},{id:301,name:"Make Your Own Chocolate Bar",description:"Customize your box with your favorite fruits and nuts.",price:140,image:"assets/custom.jpg",category:"individual",isCustom:!0,ingredients:["Choose your own: Strawberry, Blueberry, Cranberry, Kiwi, Almonds, Raisins, Cashew, Hazelnuts"]},{id:1,name:"Culture | Nuts Overload",description:"Premium dark chocolate loaded with almonds, pistachios, and cashews.",price:199,image:"assets/nuts-overload.jpg",category:"triple-choco",ingredients:["Dark chocolate (70% cocoa)","Almonds","Pistachios","Cashews","Cocoa butter"]}];let c=[];const k=40;document.getElementById("productsGrid");const O=document.getElementById("cartBtn"),p=document.getElementById("cartOverlay"),_=document.getElementById("cartSidebar"),q=document.getElementById("closeCart"),b=document.getElementById("cartItems"),A=document.getElementById("cartCount"),N=document.getElementById("cartSubtotal"),a=document.getElementById("checkoutBtn"),L=document.getElementById("mobileMenuBtn");document.getElementById("nav");document.getElementById("header");const M=document.getElementById("checkoutModal"),$=document.getElementById("closeCheckout"),v=document.getElementById("checkoutForm"),X=document.getElementById("checkoutSubtotal"),Z=document.getElementById("checkoutTotal"),G=document.getElementById("successModal"),ee=document.getElementById("closeSuccess"),f=document.getElementById("productDetailsModal"),F=document.getElementById("closeProductDetails"),U=document.getElementById("addToCartFromDetails");let S=null;document.addEventListener("DOMContentLoaded",()=>{te(),ne(),le(),me(),typeof updateHeaderUI=="function"&&updateHeaderUI()});function te(){const e=document.getElementById("grid-all-products");if(e){const t=y.filter(n=>n.category!=="individual");e.innerHTML=t.map(n=>R(n)).join("")}const o=document.getElementById("grid-custom");if(o){const t=y.filter(n=>n.category==="individual");o.innerHTML=t.map(n=>R(n)).join("")}}function R(e){const o=e.image&&e.image.trim()!=="";return`
        <div class="product-card" data-category="${e.category}">
            <div class="product-image" onclick="openProductDetails(${e.id})">
                ${o?`<img src="${e.image}" alt="${e.name}" class="product-img">`:'<div class="product-placeholder">üç´</div>'}
            </div>
            <div class="product-details">
                <h3 class="product-name">${e.name}</h3>
                <p class="product-desc">${e.description}</p>
                <div class="product-footer">
                    <span class="product-price">‚Çπ${e.price}</span>
                    <button class="add-btn ${e.isCustom?"custom-btn":""}" 
                        onclick="${e.isCustom?"openCustomization("+e.id+")":"addToCart("+e.id+")"}" 
                        aria-label="${e.isCustom?"Customize":"Add to Cart"}">
                        ${e.isCustom?"‚öôÔ∏è Select Custom Ingredient":"+"}
                    </button>
                </div>
            </div>
        </div>
    `}const h=document.getElementById("customizationModal"),z=document.getElementById("closeCustomization"),u=document.getElementById("customizationForm"),D=document.getElementById("customTotalPrice"),oe=140,g={Strawberry:7,Blueberry:9,Cranberry:6,Kiwi:6,Almonds:6,Raisins:9,Cashew:6,Hazelnuts:14};function K(){let e=oe;return document.querySelectorAll('input[name="inclusions"]:checked').forEach(n=>{const s=n.value;g[s]&&(e+=g[s])}),document.querySelectorAll('input[name="nuts"]:checked').forEach(n=>{const s=n.value;g[s]&&(e+=g[s])}),e}function Y(){const e=K();D&&(D.textContent=`‚Çπ${e} `)}window.openCustomization=function(e){h&&(h.classList.add("active"),u&&u.reset(),Y())};z&&z.addEventListener("click",()=>{h.classList.remove("active")});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('input[name="inclusions"], input[name="nuts"]').forEach(o=>{o.addEventListener("change",Y)})});u&&u.addEventListener("submit",e=>{e.preventDefault();const o=new FormData(e.target),t=o.getAll("inclusions"),n=o.getAll("nuts");if(t.length===0&&n.length===0){alert("Please select at least one inclusion or nut.");return}const s=K(),i={id:Date.now(),name:"Custom Chocolate Bar ("+t.concat(n).join(", ")+")",price:s,description:"Customized with "+t.length+" inclusions and "+n.length+" nuts.",image:"",category:"individual"};c.push({...i,quantity:1}),d(),m(),V("Custom Chocolate Bar"),h.classList.remove("active"),u.reset()});window.addToCart=function(e){const o=y.find(n=>n.id===e),t=c.find(n=>n.id===e);t?t.quantity+=1:c.push({...o,quantity:1}),d(),m(),V(o.name)};function V(e){const o=document.querySelector(".add-to-cart-notification");o&&o.remove();const t=document.createElement("div");t.className="add-to-cart-notification",t.innerHTML=`
        <span class="notif-icon">‚úì</span>
        <span class="notif-text">${e} added to cart</span>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.add("show")},10),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>{t.remove()},300)},2500)}window.updateQuantity=function(e,o){const t=c.find(n=>n.id===e);t&&(t.quantity+=o,t.quantity<=0&&(c=c.filter(n=>n.id!==e)),d(),m())};window.removeFromCart=function(e){c=c.filter(o=>o.id!==e),d(),m()};function d(){const e=c.reduce((t,n)=>t+n.quantity,0);A&&(A.textContent=e);const o=c.reduce((t,n)=>t+n.price*n.quantity,0);N&&(N.textContent=`‚Çπ${o} `),b&&(c.length===0?(b.innerHTML=`
        < div class="empty-cart-msg" >
            Your bag is empty.< br > Time to fill it with sweetness!
            </div >
        `,a&&(a.disabled=!0,a.style.opacity="0.5",a.style.cursor="not-allowed")):(a&&(a.disabled=!1,a.style.opacity="1",a.style.cursor="pointer"),b.innerHTML=c.map(t=>`
        < div class="cart-item" >
                <div class="cart-item-img">üç´</div>
                <div class="cart-item-details">
                    <div class="cart-item-name">${t.name}</div>
                    <div class="cart-item-price">‚Çπ${t.price}</div>
                    <div class="cart-item-controls">
                        <div class="qty-controls">
                            <button class="qty-btn" onclick="updateQuantity(${t.id}, -1)">-</button>
                            <span>${t.quantity}</span>
                            <button class="qty-btn" onclick="updateQuantity(${t.id}, 1)">+</button>
                        </div>
                        <button class="remove-btn" onclick="removeFromCart(${t.id})">Remove</button>
                    </div>
                </div>
            </div >
        `).join("")))}function m(){localStorage.setItem("cultureCart",JSON.stringify(c))}function ne(){const e=localStorage.getItem("cultureCart");e&&(c=JSON.parse(e),d())}function ce(){p.classList.add("active"),_.classList.add("active"),document.body.style.overflow="hidden"}function C(){p.classList.remove("active"),_.classList.remove("active"),document.body.style.overflow=""}function se(){if(c.length===0)return;try{if(window.auth&&typeof window.auth.isLoggedIn=="function"&&!window.auth.isLoggedIn()){const t=document.getElementById("loginPromptModal");t&&t.classList.add("active"),C();return}}catch(t){console.log("Auth check failed, proceeding with checkout:",t)}const e=c.reduce((t,n)=>t+n.price*n.quantity,0),o=e+k;X.textContent=`‚Çπ${e} `,Z.textContent=`‚Çπ${o} `,typeof autoFillCheckout=="function"&&autoFillCheckout(),C(),M.classList.add("active")}ee.addEventListener("click",()=>{G.classList.remove("active")});const ie=document.getElementById("loginPromptModal"),H=document.getElementById("closeLoginPrompt");H&&H.addEventListener("click",()=>{ie.classList.remove("active")});const W=document.getElementById("upiModal"),ae=document.getElementById("closeUpi"),re=document.getElementById("confirmUpiBtn");ae.addEventListener("click",()=>{W.classList.remove("active")});re.addEventListener("click",()=>{const e=document.getElementById("transactionId").value;if(!e){alert("Please enter the Transaction ID");return}W.classList.remove("active"),J(new FormData(v),"upi",e)});const de=document.getElementsByName("paymentMethod");de.forEach(e=>{e.addEventListener("change",o=>{})});function le(){if(O&&O.addEventListener("click",ce),q&&q.addEventListener("click",C),p&&p.addEventListener("click",C),a&&a.addEventListener("click",se),$&&$.addEventListener("click",()=>{M.classList.remove("active")}),v&&v.addEventListener("submit",ue),L){const o=document.getElementById("nav");L.addEventListener("click",()=>{o.classList.toggle("active"),L.classList.toggle("active")})}const e=document.getElementById("closeLoginPrompt");e&&e.addEventListener("click",()=>{const o=document.getElementById("loginPromptModal");o&&o.classList.remove("active")}),F&&F.addEventListener("click",()=>{f.classList.remove("active")}),U&&U.addEventListener("click",()=>{S&&(addToCart(S),f.classList.remove("active"))})}window.openProductDetails=function(e){const o=y.find(n=>n.id===e);if(!o)return;S=e,document.getElementById("productDetailsName").textContent=o.name;const t=document.getElementById("productIngredientsList");o.ingredients&&o.ingredients.length>0?t.innerHTML=o.ingredients.map(n=>`< li >‚úì ${n}</li > `).join(""):t.innerHTML="<li>No specific ingredients listed</li>",document.getElementById("commonIngredients").textContent=I.commonIngredients,document.getElementById("productNote").textContent=I.note,document.getElementById("productDirections").textContent=I.directions,document.getElementById("productDetailsPrice").textContent=o.price,f&&f.classList.add("active")};function ue(e){e.preventDefault();const o=e.target.querySelector('button[type="submit"]');if(o.disabled)return;o.textContent,o.disabled=!0,o.textContent="Processing...";const t=new FormData(e.target),n=t.get("paymentMethod");n==="cod"?J(t,"cod"):n==="upi"&&document.getElementById("upiModal").classList.add("active")}function J(e,o,t=""){const n=e.get("name"),s=e.get("area"),i="#CULTURE-"+Math.floor(Math.random()*1e4),E=c.reduce((r,x)=>r+x.price*x.quantity,0),Q=E+k;let P=e.get("email")||"";if(typeof getCurrentUser=="function"){const r=getCurrentUser();r&&(P=r.email)}const T=Math.floor(1e5+Math.random()*9e5).toString();document.getElementById("successName").textContent=n,document.getElementById("successArea").textContent=s,document.getElementById("successOrderId").textContent=i,document.getElementById("successVerificationCode").textContent=T,M.classList.remove("active"),G.classList.add("active"),ge({orderId:i,timestamp:new Date().toISOString(),customerName:n,mobile:e.get("mobile"),email:P,address:e.get("address"),area:s,pincode:e.get("pincode"),deliveryTime:e.get("deliveryTime"),paymentMethod:o,transactionId:t,items:c.map(r=>({name:r.name,quantity:r.quantity,price:r.price})),subtotal:E,deliveryFee:k,total:Q,verificationCode:T}),c=[],d(),m(),v.reset(),document.getElementById("transactionId").value=""}function me(){const e=document.querySelectorAll(".product-card, .section-title, .about-content"),o=()=>{const n=window.innerHeight,s=150;e.forEach(i=>{i.getBoundingClientRect().top<n-s&&i.classList.add("active")})};window.addEventListener("scroll",o),o();const t=document.getElementById("header");window.addEventListener("scroll",()=>{window.scrollY>50?t.classList.add("scrolled"):t.classList.remove("scrolled")})}function ge(e){const o={action:"placeOrder",apiKey:j,orderId:e.orderId,customerName:e.customerName,mobile:e.mobile,email:e.email,address:e.address,area:e.area,pincode:e.pincode,deliveryTime:e.deliveryTime,paymentMethod:e.paymentMethod,transactionId:e.transactionId||"",items:e.items,subtotal:e.subtotal,deliveryFee:e.deliveryFee,total:e.total,userEmail:e.email,verificationCode:e.verificationCode};fetch(w,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(o)}).then(t=>t.json()).then(t=>{t.success?(console.log("Order saved to Google Sheets successfully"),t.verificationCode&&(document.getElementById("successVerificationCode").textContent=t.verificationCode)):console.error("Google Sheets error:",t.error)}).catch(t=>{console.error("Error saving to Google Sheets:",t)})}const l=document.getElementById("contactForm");l&&l.addEventListener("submit",async e=>{e.preventDefault();const o=l.querySelector('button[type="submit"]'),t=o.textContent;o.textContent="Sending...",o.disabled=!0;const n={action:"submitInquiry",apiKey:j,name:document.getElementById("name").value,email:document.getElementById("email").value,message:document.getElementById("message").value};try{w!=="YOUR_WEB_APP_URL_HERE"&&await fetch(w,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(n)}),alert("Thank you! Your message has been sent. We will get back to you soon."),l.reset()}catch(s){console.error("Error submitting inquiry:",s),alert("Thank you for your message! We will get back to you soon."),l.reset()}finally{o.textContent=t,o.disabled=!1}});const ye={threshold:.15,rootMargin:"0px 0px -50px 0px"},B=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting&&o.target.classList.add("active")})},ye);document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".features, .menu, .about, .testimonials, .contact").forEach(n=>{n.classList.add("reveal"),B.observe(n)}),document.querySelectorAll(".product-card").forEach(n=>{n.classList.add("reveal-stagger"),B.observe(n)}),document.querySelectorAll(".testimonial-card").forEach(n=>{n.classList.add("reveal"),B.observe(n)}),document.querySelectorAll('a[href^="#"]').forEach(n=>{n.addEventListener("click",function(s){s.preventDefault();const i=document.querySelector(this.getAttribute("href"));i&&i.scrollIntoView({behavior:"smooth",block:"start"})})})});console.log("Premium enhancements loaded successfully!");
